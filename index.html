<!DOCTYPE html>
<html>
<head>
	<title>R-SCUAD TECH</title>

	<meta name="description" content="Basestation Robot RSCUAD">
	<meta name="author" content="Danu Andrean">
	<link rel="stylesheet" type="text/css" href="/assets/css/style.css" />

	<link rel="stylesheet" href="/assets/css/bootstrap-min.css" >

	<script src="/assets/js/jquery-slim.js" ></script>
	<script src="/assets/js/popper.js" ></script>
	<script src="/assets/js/bootstrap-min.js" ></script>
	<script src="/assets/js/bootstrap-min.js" ></script>
	<script src="/assets/js/ajax.js" ></script>
	
	<script src="/assets/client.js" ></script>

</head>
<body>
	<div class="container">
		<div class="row mt-3">
			<div class="col-5 ">
				<h1 class="title">BASE STATION R-SCUAD</h1>
			</div>
			<div class="col-2">
				<div id="state"></div>
			</div>
			<div class="col-5">
				<div class="selection">
					<div class="list-group" id="pills-tab" >
					<ul class="nav nav-pills" id="pills-tab" role="tablist">
						<li class="nav-item">
						<a class="nav-link btn btn-warning mr-4" id="myBtn">
							<span id="refree">NONE</span>
						</a>
						</li>
						<li class="nav-item">
						<a class="nav-link active" id="list-robot-list" data-toggle="pill" href="#pills-robot" role="tab" aria-controls="robot">ROBOT</a>
						</li>
						<li class="nav-item">
						<a class="nav-link" id="list-stream-list" data-toggle="pill" href="#pills-stream" role="tab" aria-controls="stream">STREAM</a>
						</li>
						<li class="nav-item">
						<a class="nav-link" id="list-position-list" data-toggle="pill" href="#pills-position" role="tab" aria-controls="position" aria-selected="false">POSITION</a>
						</li>
					</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="container">
		<div class="tab-content" id="nav-tabContent">
			<div class="tab-pane fade show active" id="pills-robot" role="tabpanel" aria-labelledby="list-robot-list">
				<div class="row" id="draw">
					<div class="col-2 offset-1">
						<div class="card">
						<div class="card-body" id="r1">
							<div class="name">
							<h2 >Robot 1</h2>
							</div>
							<img class="draw" src="/assets/image/robot-standby.png" alt="" id="rr1">
						</div>
						</div>
					</div>
					<div class="col-2 ">
						<div class="card">
						<div class="card-body" id="r2">
							<div class="name">
							<h2 >Robot 2</h2>
							</div>
							<img class="draw" src="/assets/image/robot-standby.png" alt="" id="rr2">
						</div>
						</div>
					</div>
					<div class="col-2 ">
						<div class="card " >
						<div class="card-body" id="r3">
							<div class="name">
							<h2 >Robot 3</h2>
							</div>
							<img class="draw" src="/assets/image/robot-standby.png" alt="" id="rr3">
						</div>
						</div>
					</div>
					<div class="col-2 ">
						<div class="card" >
						<div class="card-body" id="r4">
							<div class="name">
							<h2 >Robot 4</h2>
							</div>
							<img class="draw" src="/assets/image/robot-standby.png" alt="" id="rr4">
						</div>
						</div>
					</div>
					<div class="col-2 ">
						<div class="card" >
						<div class="card-body" id="r5">
							<div class="name">
							<h2 >Robot 5</h2>
							</div>
							<img class="draw" src="/assets/image/robot-standby.png" alt="" id="rr5">
						</div>
						</div>
					</div>
				</div>
			</div>
			<div class="tab-pane fade" id="pills-stream" role="tabpanel" aria-labelledby="list-stream-list">
				<div class="row">
					<div class="col-md-4 offset-2 cam-robot">
						<img id="video1" src="" alt="Video Stream">

					</div>
					<div class="col-md-4 cam-robot">
						<img id="video2" src="" alt="Video Stream">

					</div>
					<div class="col-md-4 cam-robot">
						<img id="video3" src="" alt="Video Stream">

					</div>
					<div class="col-md-4 cam-robot">
						<img id="video4" src="" alt="Video Stream">

					</div>
					<div class="col-md-4 cam-robot">
						<img id="video5" src="" alt="Video Stream">

					</div>
				</div>
			</div>
			<div class="tab-pane fade" id="pills-position" role="tabpanel" aria-labelledby="list-position-list">
				<div class="page">
				<img src="/assets/image/cat.png" alt="">
				<p class="tab-font"> Page under construction...!</p>
				</div>
			</div>
		</div>
	</div> 

	<div class="row mt-5" id="set">
		<div class="col-2 bar offset-1">
			<div class="card">
				<div class="card-body">
					<div class="input-group input-group-sm ">

						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> TILT</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="tilt_1" value="">

						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> BALL</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="ball_1" value="">
					</div>
					
					<div class="input-group input-group-sm ">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm"> PAN</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="pan_1" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> COUNT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="count_1" value="">
					</div>
					<div class="input-group input-group-sm mb-2">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">GYRO</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="gyro_1" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">LIMIT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="limit_1" value="">
					</div>
					<div class="input-group input-group-sm ">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">SEND</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="send_1" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">RECV</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="recv_1" value="">
					</div>
				</div>
			</div>
		</div>
		<div class="col-2 bar ">
			<div class="card">
				<div class="card-body">
					<div class="input-group input-group-sm ">

						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> TILT</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="tilt_2" value="">

						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> BALL</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="ball_2" value="">
					</div>
					
					<div class="input-group input-group-sm ">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm"> PAN</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="pan_2" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> COUNT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="count_2" value="">
					</div>
					<div class="input-group input-group-sm mb-2">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">GYRO</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="gyro_2" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">LIMIT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="limit_2" value="">
					</div>
					<div class="input-group input-group-sm ">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">SEND</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="send_2" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">RECV</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="recv_2" value="">
					</div>
				</div>
			</div>
		</div>
		<div class="col-2 bar ">
			<div class="card ">
				<div class="card-body">
					<div class="input-group input-group-sm ">

						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> TILT</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="tilt_3" value="">

						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> BALL</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="ball_3" value="">
					</div>
					
					<div class="input-group input-group-sm ">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm"> PAN</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="pan_3" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> COUNT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="count_3" value="">
					</div>
					<div class="input-group input-group-sm mb-2">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">GYRO</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="gyro_3" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">LIMIT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="limit_3" value="">
					</div>
					<div class="input-group input-group-sm ">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">SEND</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="send_3" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">RECV</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="recv_3" value="">
					</div>
				</div>
			</div>
		</div>
		<div class="col-2 bar ">
			<div class="card ">
				<div class="card-body">
					<div class="input-group input-group-sm ">

						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> TILT</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="tilt_4" value="">

						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> BALL</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="ball_4" value="">
					</div>
					
					<div class="input-group input-group-sm ">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm"> PAN</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="pan_4" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> COUNT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="count_4" value="">
					</div>
					<div class="input-group input-group-sm mb-2">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">GYRO</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="gyro_4" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">LIMIT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="limit_4" value="">
					</div>
					<div class="input-group input-group-sm ">
						<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">SEND</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="send_4" value="">
						<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">RECV</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="recv_4" value="">
					</div>
				</div>
			</div>
		</div>
		<div class="col-2 bar ">
			<div class="card ">
			<div class="card-body">
				<div class="input-group input-group-sm ">

					<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> TILT</span>
					</div>
					<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="tilt_5" value="">

					<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> BALL</span>
					</div>
					<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="ball_5" value="">
				</div>
		
				<div class="input-group input-group-sm ">
					<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm"> PAN</span>
					</div>
					<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="pan_5" value="">
					<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm"> COUNT</span>
					</div>
					<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="count_5" value="">
				</div>
				<div class="input-group input-group-sm mb-2">
					<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">GYRO</span>
						</div>
						<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="gyro_5" value="">
						<div class="input-group-prepend ">
							<span class="input-group-text" id="inputGroup-sizing-sm">LIMIT</span>
						</div>
						<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="limit_5" value="">
				</div>
				<div class="input-group input-group-sm ">
					<div class="input-group-prepend">
						<span class="input-group-text" id="inputGroup-sizing-sm">SEND</span>
					</div>
					<input type="text" class="form-control mr-2" aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="send_5" value="">
					<div class="input-group-prepend ">
						<span class="input-group-text" id="inputGroup-sizing-sm">RECV</span>
					</div>
					<input type="text" class="form-control " aria-label="Small" aria-describedby="inputGroup-sizing-xm" placeholder="-" id="recv_5" value="">
				</div>
				</div>
			</div>
		</div>
	</div> <!--end set-->

	<!-- The Modal -->
	<div id="myModal" class="modals">
		<!-- Modal content -->
		<div class=" shadow modal-contents rounded">
			<span class="close">&times;</span>
			<p>Package Identity</p>
			<p class="ml-5">0 : Init<br>1 : Ready<br>2 : Set<br>3 : Play<br>4 : Finish</p>
		</div>
	</div>

	<script>

		var modal = document.getElementById("myModal");
		var btn = document.getElementById("myBtn");
		var span = document.getElementsByClassName("close")[0];

		btn.onclick = function() {
			modal.style.display = "block";
		}
		
		// When the user clicks on <span> (x), close the modal
		span.onclick = function() {
			modal.style.display = "none";
		}
		
		// When the user clicks anywhere outside of the modal, close it
		window.onclick = function(event) {
			if (event.target == modal) {
			modal.style.display = "none";
			}
		}

		function Init(){
			let status = new Status();
			status.RobotLoss1();
			status.RobotLoss2();
			status.RobotLoss3();
			status.RobotLoss4();
			status.RobotLoss5();	
		}

		function EntryData(data){
			let status = new Status();
			let entry = new Entry(data, data[9], status);
			entry.Calculation();
		}

		$(function () {
			var ws;
			let state = document.getElementById('state');

			if (window.WebSocket === undefined) {
				alert("Your browser does not support WebSockets");
				return;
			} else {
				ws = initWS();
			}

			function initWS() {
				var socket = new WebSocket('ws://' + window.location.host + '/ws'),
					container = $("#container")
				socket.onopen = function() {
					state.classList.add("staterun");
					Init();
				};
				socket.onmessage = function (e) {
					let data = e.data
					data = data.replace(/(\r\n|\n|\r)/gm, "");
					data = data.replace('\"', "");
					data = data.replace('\"', "");

					data_all = data.split(",");
					// console.log(e.data);
					EntryData(data_all);
				}
				socket.onclose = function () {
					state.classList.remove("staterun");
				}

				return socket;
			}
			setInterval(function() {
				ws.send(JSON.stringify({ Num: 0 }));	// get callback for refereebox
				ws.send(JSON.stringify({ Num: 1 }));
				ws.send(JSON.stringify({ Num: 2 }));
				ws.send(JSON.stringify({ Num: 3 }));
				ws.send(JSON.stringify({ Num: 4 }));
				ws.send(JSON.stringify({ Num: 5 }));
			}, 100);
		});


		//stream 1
		var socketR1 = new WebSocket('ws://' + window.location.host + '/video1');

		socketR1.onmessage = function(event) {
			var imageBlob = new Blob([event.data], {type: 'image/jpeg'});
			var imageURL = URL.createObjectURL(imageBlob);

			document.getElementById("video1").src = imageURL;
		};

		socketR1.onerror = function(error) {
			console.error("WebSocket error:", error);
		};

		//stream 2
		var socketR2 = new WebSocket('ws://' + window.location.host + '/video2');

		socketR2.onmessage = function(event) {
			var imageBlob = new Blob([event.data], {type: 'image/jpeg'});
			var imageURL = URL.createObjectURL(imageBlob);

			document.getElementById("video2").src = imageURL;
		};

		socketR2.onerror = function(error) {
			console.error("WebSocket error:", error);
		};
		
		//stream 3
		var socketR3 = new WebSocket('ws://' + window.location.host + '/video3');

		socketR3.onmessage = function(event) {
			var imageBlob = new Blob([event.data], {type: 'image/jpeg'});
			var imageURL = URL.createObjectURL(imageBlob);

			document.getElementById("video3").src = imageURL;
		};

		socketR3.onerror = function(error) {
			console.error("WebSocket error:", error);
		};

		//stream 4
		var socketR4 = new WebSocket('ws://' + window.location.host + '/video4');

		socketR4.onmessage = function(event) {
			var imageBlob = new Blob([event.data], {type: 'image/jpeg'});
			var imageURL = URL.createObjectURL(imageBlob);

			document.getElementById("video4").src = imageURL;
		};

		socketR4.onerror = function(error) {
			console.error("WebSocket error:", error);
		};

		//stream 5
		var socketR5 = new WebSocket('ws://' + window.location.host + '/video5');

		socketR5.onmessage = function(event) {
			var imageBlob = new Blob([event.data], {type: 'image/jpeg'});
			var imageURL = URL.createObjectURL(imageBlob);

			document.getElementById("video5").src = imageURL;
		};

		socketR5.onerror = function(error) {
			console.error("WebSocket error:", error);
		};
    </script>
</body>
</html>
